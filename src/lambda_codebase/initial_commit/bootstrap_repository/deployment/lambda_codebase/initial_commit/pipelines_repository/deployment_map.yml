pipelines:
  - name: sample-iam  # The name of your pipeline (This will match the name of your repository)
    type:
      source: 
        name: codecommit
        account_id: 228171733466
      build: 
        name: codebuild
      deploy: 
        name: cloudformation
    params:
        notification_endpoint: bundyf@amazon.nl # The Notification (user/team/slack) responsible for this pipeline
    targets:  # Deployment stages
      - /banking/testing # will use action from type defined above,
      - path: /banking/production
        change_set: approval_needed # override deploy action above and insert a approval in between create + execute change set

  - name: sample-vpc
    type: # if we omit build and deploy type we get a default of codebuild as the build and cloudformation as the deploy. if using codecommit, account_id is required
      source:
        name: github
        repository: example-vpc-adf # Optional, above name property will be used if this is not specified
        owner: bundyfx
        oauth_token_path: /github/secret # The path in AWS Secrets Manager that holds the GitHub Oauth token
        json_field: token_github # The field (key) name of the json object stored in AWS Secrets Manager that holds the Oauth token
    params:
        notification_endpoint: bundyf@amazon.nl
    targets: # Long hand syntax including regions and names for stages
      - path: /banking/testing
        name: fancy-name

  - name: sample-ec2-app-codedeploy
    type:
      source:
        name: codecommit
        account_id: 228171733466
    targets:
      - 130330464033
