# // Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.
# // SPDX-License-Identifier: Apache-2.0

AWSTemplateFormatVersion: "2010-09-09"
Description: ADF CloudFormation Template (Global) for IAM in the Deployment Account
Resources:
  CloudFormationDeploymentPolicy:
    # This is the policy that will be used to deploy CloudFormation resources from
    # within the target account. You should scope this policy depending
    # On what you would like to deploy within certain Organizational Units.
    # NOTE: below is a sample IAM policy. This policies should NOT be used for purposes other than testing.
    Type: AWS::IAM::Policy
    Properties:
      PolicyName: "adf-cloudformation-deployment-role-policy"
      PolicyDocument:
        Version: "2012-10-17"
        Statement:
          - Effect: Allow
            Sid: "CloudFormation"
            Action: # These are examples..
              - "s3:*"
              - "ecr:*"
            Resource:
              - "*"
      Roles:
        - adf-cloudformation-deployment-role

  # ADFTerraformRole:
  #   # This is the role that will be used to deploy Terraform resources from within 
  #   # the target account. You should scope this policy depending on what you would 
  #   # like to deploy within certain Organizational Units.
  #   # NOTE: below is a sample IAM policy. This policies should NOT be used for purposes other than testing.
  #   # Uncomment the `ADFTerraformRole` and `ADFTerraformPolicy` resources if you want to enable Terraform support in ADF.
  #   Type: AWS::IAM::Role
  #   Properties:
  #     RoleName: "adf-terraform-role"
  #     AssumeRolePolicyDocument:
  #       Version: "2012-10-17"
  #       Statement:
  #         - Effect: Allow
  #           Sid: "AssumeRole"
  #           Principal:
  #             AWS:
  #               - !Sub arn:aws:iam::${AWS::AccountId}:role/adf-codebuild-role
  #           Action:
  #             - sts:AssumeRole
  #     Path: /
  # ADFTerraformPolicy:
  #   Type: AWS::IAM::Policy
  #   Properties:
  #     PolicyName: "adf-terraform-policy"
  #     PolicyDocument:
  #       Version: "2012-10-17"
  #       Statement:
  #         - Effect: Allow
  #           Action:
  #             - "events:PutRule"
  #             - "events:PutTargets"
  #             - "events:DeleteRule"
  #             - "events:DescribeRule"
  #             - "events:ListTagsForResource"
  #             - "events:ListTargetsByRule"
  #             - "events:RemoveTargets"
  #             - "sns:CreateTopic"
  #             - "sns:GetTopicAttributes"
  #             - "sns:SetTopicAttributes"
  #             - "sns:ListTagsForResource"
  #             - "sns:DeleteTopic"
  #           Resource:
  #             - "*"
  #     Roles:
  #       - !Ref ADFTerraformRole